---
title: "6. Уменьшение размерности: CA и MCA"
author: "Г. Мороз"
editor_options: 
  chunk_output_type: console
---

<style>
.parallax {
    /* The image used */
    background-image: url("6_DCA.jpg");

    /* Set a specific height */
    min-height: 300px; 

    /* Create the parallax scrolling effect */
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: auto;
}
</style>

<div class="parallax"></div>


### 1. Введение

#### 1.1 Библиотеки
```{r}
library(tidyverse)
library(GGally)
library(ca)
```

#### 1.2 Фамильная честь Вустеров
В данной лекции я буду использовать данные из романа П. Г. Вудхауза [“Фамильная честь Вустеров”](https://en.wikipedia.org/wiki/The_Code_of_the_Woosters). В датасете собраны несколько переменных:

* chapter --- номер главы
* гарольд --- количество появлений имени в каждой из глав
* гасси --- количество появлений имени в каждой из глав
* далия --- количество появлений имени в каждой из глав
* дживс --- количество появлений имени в каждой из глав
* мадлен --- количество появлений имени в каждой из глав
* оутс --- количество появлений имени в каждой из глав
* спод --- количество появлений имени в каждой из глав
* стиффи --- количество появлений имени в каждой из глав
* сэр --- количество появлений имени в каждой из глав

```{r}
wodehouse <- read.csv("https://goo.gl/bSxdMZ")
library(GGally)
ggpairs(wodehouse[,-1])
```


#### 1.3 Нидерланлские каузативы
Dataset and description from [paper by Natalia Levshina](https://goo.gl/v6AmVj). Modern standard Dutch has two periphrastic causatives with the infinitive: the constructions with doen ‘do’ and laten ‘let’. The study is based on an 8-million token corpus of Netherlandic and Belgian Dutch. After the manual cleaning, there were left with 6,808 observations, which were then coded for seven semantic, syntactic, geographical and thematic variables.

* Aux --- a factor that specifies the causative auxiliary with levels laten and doen.
* Country --- a factor with levels NL (the Netherlands) and BE (Belgium).
* Causation --- a factor that describes the type of causation with levels Affective, Inducive, Physical and Volitional
* EPTrans --- a factor that specifies the transitivity of the Effected Predicate with levels Intr (intransitive) and Tr (transitive).
* EPTrans1 --- a factor with levels Intr and Tr. It is very similar to the previous one, except for a few observations.

```{r}
dutch_caus <- read.csv("https://goo.gl/2yAR3T")
```


<div class="parallax"></div>

### 2. CA

```{r}
rownames(wodehouse) <- wodehouse$chapter
ca <- ca(wodehouse[-1])
ca
summary(ca) # extended results
plot(ca) # symmetric map
plot(ca, mass = TRUE, contrib = "absolute", map =
   "rowgreen", arrows = c(FALSE, TRUE))
```

Сравните с соответствующими данными PCA:

```{r, echo=FALSE}
wodehouse2 <- read.csv("https://goo.gl/8RJDwK")
rownames(wodehouse2) <- wodehouse2$chapter
wodehouse2 <- wodehouse2[,-1]
PCA <- prcomp(wodehouse2)
library(ggfortify)
autoplot(PCA,
         shape = FALSE,
         loadings = TRUE,
         label = TRUE,
         loadings.label = TRUE)+
  theme_bw()
```

<div class="parallax"></div>

### 3. MCA
```{r}
MCA <- MASS::mca(dutch_caus[,-1])
dutch_caus <- cbind(dutch_caus, MCA$rs)
dutch_caus %>% 
  ggplot(aes(`1`, `2`, color = Aux))+
  geom_point()+
  stat_ellipse()+
  theme_bw()
```

<div class="parallax"></div>

### 4. DCA
Комбинация CA и  дискрименантного анализа называется Discriminant Correspondence Analysis.

<div class="parallax"></div>